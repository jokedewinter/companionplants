function build_lists(){sessionStorage.get_ready||(sessionStorage.get_ready="true",$.ajax({url:"files/companions.json",dataType:"text",success:function(e){var s=$.parseJSON(e);create_plants_array(s),create_letters_array(s)},error:function(e,s,t){output="<p>Something went wrong with reading the database file: <em>"+t+"</em></p>",$("#update").html(output)}}))}function create_plants_array(e){var s=0;$.each(e,function(e,t){plants[s]=new Array,plants[s][0]=e,plants[s][1]=new Array,plants[s][2]=new Array,t.good&&(plants[s][1]=t.good),t.bad&&(plants[s][2]=t.bad),s++}),sessionStorage.plants=JSON.stringify(plants);JSON.parse(sessionStorage.plants)}function create_letters_array(e){var s="";$.each(e,function(e){var t=e.charAt(0);t!=s?(""!=s?i++:i=0,letters[i]=new Array,letters[i].push(t),letters[i].push(e),s=t):letters[i].push(e)}),sessionStorage.letters=JSON.stringify(letters);JSON.parse(sessionStorage.letters)}function search_list(){$("#search_list").css("display","block");for(var e=JSON.parse(sessionStorage.plants),s=e.length,t="",r=0;s>r;r++)t+="<li>",t+='<a href="#'+e[r][0]+'">',t+=e[r][0],t+="</a>",t+="</li>";$("#search_list ul").html(t),$("#search_list ul li a").click(function(e){e.preventDefault();var s=$(this).attr("href"),s=s.substring(1,s.length);show_result(s)})}function search_letter(){$("#search_letter").css("display","block");for(var e=JSON.parse(sessionStorage.letters),s=e.length,t="",r=0;s>r;r++)t+="<li>",t+='<a href="#'+e[r][0]+'">',t+=e[r][0],t+="</a>",t+="</li>";$("#search_letter ul#letters").html(t),$("#search_letter ul li a").click(function(t){t.preventDefault();for(var r=$(this).attr("href"),r=r.substring(1,r.length),a=0;s>a;a++)if(e[a][0]==r){var l=e[a];break}$("#search_letter-plants h3").remove(),$("#search_letter-plants ul").remove(),$("#search_letter-plants").append("<h3>"+l[0]+"</h3>"),$("#search_letter-plants").append('<ul class="columns"></ul>');for(var a=1;a<l.length;a++){var n="";n+="<li>",n+='<a href="#'+l[a]+'">',n+=l[a],n+="</a>",n+="</li>",$("#search_letter-plants ul").append(n)}search_letter_plants()})}function search_letter_plants(){$("#search_letter-plants ul li a").click(function(e){e.preventDefault(),console.log("click");var s=$(this).attr("href"),s=s.substring(1,s.length);console.log(s),show_result(s)})}function search_name(){$("#search_name").css("display","block"),$("#plant_name").focus();{var e=JSON.parse(sessionStorage.plants);e.length}$("#ask_plant_name").submit(function(e){e.preventDefault(),$("#not_found").empty();var s=$(this).serializeArray();s=s[0].value,s=s.toLowerCase(),plant_name_split=s.split(" ");for(var t=0;t<plant_name_split.length;t++)plant_name_split[t]=plant_name_split[t].charAt(0).toUpperCase()+plant_name_split[t].substring(1);s=plant_name_split.join(" ");for(var r=!1,a=JSON.parse(sessionStorage.plants),l=a.length,t=0;l>t;t++)if(a[t][0]==s){show_result(s),r=!0;break}1==r?$("#ask_plant_name")[0].reset():($("#ask_plant_name")[0].reset(),$("#not_found").empty(),$("#not_found").html("Sorry. <strong>"+s+"</strong> is not in the list of plants."))})}function search_random(){$("#search_random").css("display","block");var e=JSON.parse(sessionStorage.plants),s=e[Math.floor(Math.random()*e.length)];show_result(s[0])}function show_result(e){$("#search_result").css("display","block");for(var s=JSON.parse(sessionStorage.plants),t=s.length,r=0;t>r;r++)if(s[r][0]==e){var a=s[r][1],l=s[r][2];break}if($("#search_result #like ul").remove(),$("#search_result #like p").remove(),$("#search_result #dislike ul").remove(),$("#search_result #dislike p").remove(),$("#search_result h2").html(e),""!=a){$("#search_result #like").append('<ul class="columns"></ul>');for(var r=0;r<a.length;r++)$("#search_result #like ul").append("<li>"+a[r]+"</li>")}else $("#search_result #like").append("<p>Loves nothing.</p>");if(""!=l){$("#search_result #dislike").append('<ul class="columns"></ul>');for(var r=0;r<l.length;r++)$("#search_result #dislike ul").append("<li>"+l[r]+"</li>")}else $("#search_result #dislike").append("<p>Loves everything!</p>");window.scrollTo(0,0)}$(document).ready(function(){build_lists(),sessionStorage.chosen_search="",$("#search_method ul li a").click(function(e){e.preventDefault(),s=sessionStorage.chosen_search,previous_search=s;var s=$(this).attr("href"),s=s.substring(1,s.length);sessionStorage.chosen_search=s,s!=previous_search&&($("#"+previous_search).css("display","none"),$("#search_result").css("display","none")),window.scrollTo(0,0),search_method[s]()})});var plants=Array(),types=Array(),letters=Array(),search_method={search_list:search_list,search_letter:search_letter,search_name:search_name,search_random:search_random};